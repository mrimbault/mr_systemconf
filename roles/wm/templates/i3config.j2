# i3 config file
#
# This file has been generated by i3-config-wizard(1), and manually edited.
# Please see https://i3wm.org/docs/userguide.html for a complete reference!
#
# This config file uses keycodes (bindsym) and was written for the AZERTY
# layout, with Vim-like bindings.
#

# Set i3 escape key to <super>.
set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:Hack, FontAwesome 11

# Use Vim keys for focus, movement, and resize directions.
set $left h
set $down j
set $up k
set $right l

# Use Mouse+$mod to drag floating windows to their wanted position.
floating_modifier $mod

# Start a terminal.
bindsym $mod+Return exec i3-sensible-terminal

# Kill focused window, asking confirmation.
set $close "Close the window? (y/n)"
mode $close {
    bindsym y kill, mode default
    bindsym Return kill, mode default
    bindsym n mode default
    bindsym Escape mode default
}
bindsym $mod+Shift+q mode $close

# Program launcher: rofi.
bindsym $mod+d exec --no-startup-id rofi -show run

# Easy switch between windows using rofi.
bindsym $mod+Tab exec --no-startup-id rofi -show window
# Note: Available alternate bindings for similar features:
# bindsym $mod+Shift+Tab
# bindsym $mod+Control+Tab

# Change focus.
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
# Alternatively, use the cursor keys.
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# Move focused window.
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
# Alternatively, use the cursor keys.
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Split in horizontal orientation.
bindsym $mod+s split h
# Split in vertical orientation.
bindsym $mod+v split v

# Enter fullscreen mode for the focused container.
bindsym $mod+f fullscreen toggle

# Change container layout (stacked, tabbed, toggle split).
bindsym $mod+Shift+t layout stacking
bindsym $mod+t layout tabbed
bindsym $mod+e layout toggle split

# Toggle tiling / floating.
bindsym $mod+Shift+space floating toggle

# Change focus between tiling / floating windows.
bindsym $mod+space focus mode_toggle

# Focus the parent container.
bindsym $mod+a focus parent

# move the currently focused window to the scratchpad
# FIXME what is the scratchpad?
# FIXME will not work with azerty keyboard ; in fact, that breaks shifting to desktop "6"
bindsym $mod+Shift+minus move scratchpad

# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
# FIXME what is the scratchpad?
# FIXME will not work with azerty keyboard ; in fact, that breaks shifting to desktop "6"
bindsym $mod+minus scratchpad show

# Define names for default workspaces for which we configure key bindings later on.
# We use variables to avoid repeating the names in multiple places.
set $ws1 "1"
set $ws2 "2"
set $ws3 "3"
set $ws4 "4"
set $ws5 "5"
set $ws6 "6"
set $ws7 "7"
set $ws8 "8"
set $ws9 "9"
set $ws10 "10"

# Move to [n]ext and [p]revious workspaces.
bindsym $mod+p workspace prev_on_output
bindsym $mod+n workspace next_on_output

# Switch to workspace.
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# Move focused container to workspace.
bindsym $mod+Shift+1 move container to workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8
bindsym $mod+Shift+9 move container to workspace $ws9
bindsym $mod+Shift+0 move container to workspace $ws10

# Reload the configuration file.
bindsym $mod+Shift+c reload
# Restart i3 inplace (preserves your layout/session, can be used to upgrade
# i3).
bindsym $mod+Shift+r restart

# Resize window (use variable contents as mode name to display the information
# message).
set $mode_resize Resize ($left) shrink width, ($right) grow width, ($up) shrink height, ($down) grow height
mode "$mode_resize" {
        # These bindings trigger as soon as you enter the resize mode.

        # Pressing left will shrink the window’s width.
        # Pressing right will grow the window’s width.
        # Pressing up will shrink the window’s height.
        # Pressing down will grow the window’s height.
        bindsym $left       resize shrink width 10 px or 10 ppt
        bindsym $right      resize grow width 10 px or 10 ppt
        bindsym $up         resize shrink height 10 px or 10 ppt
        bindsym $down       resize grow height 10 px or 10 ppt
        # Same bindings, but for the arrow keys.
        bindsym Left        resize shrink width 10 px or 10 ppt
        bindsym Right       resize grow width 10 px or 10 ppt
        bindsym Up          resize shrink height 10 px or 10 ppt
        bindsym Down        resize grow height 10 px or 10 ppt

        # Back to normal mode.
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+r mode "default"
}
bindsym $mod+r mode "$mode_resize"

# FIXME window mode: replace resize mode, and add window movement and position change


###############
# Exit i3 mode
###############
# (original: https://faq.i3wm.org/question/239/how-do-i-suspendlockscreen-and-logout.1.html)
# Put bindings on printed text as a reminder.
set $mode_system System (l) lock, (s) suspend, (h) hibernate, (Shift+e) logout, (Shift+r) reboot, (Shift+s) shutdown
mode "$mode_system" {
        bindsym l exec --no-startup-id "i3lock", mode "default"
        bindsym s exec --no-startup-id "i3lock && systemctl suspend", mode "default"
        # FIXME hibernate mode does not work ?
        bindsym h exec --no-startup-id "i3lock && systemctl hibernate", mode "default"
        bindsym Shift+e exec --no-startup-id "i3-msg exit", mode "default"
        bindsym Shift+r exec --no-startup-id "systemctl reboot", mode "default"
        bindsym Shift+s exec --no-startup-id "systemctl poweroff", mode "default"
        # Back to normal mode.
        bindsym Return mode "default"
        bindsym Escape mode "default"
        bindsym $mod+BackSpace mode "default"
}
# FIXME use i3nagbar to put explicit message and ask for confirmation ?
bindsym $mod+BackSpace mode "$mode_system"

########################
# Select monitor layout.
# Note: use a local custom script, depends on rofi, mons and xrandr.
bindsym $mod+F1 exec --no-startup-id select_monitor_layout

######################
# Change global theme.
# Note: use a local glocal custom script, that calls several local custom
# scripts (one for each themed application).
# Use theme files from {{ theme_dir }} directory.
bindsym $mod+dollar exec --no-startup-id select_theme

###############
# Ideas
###############
# FIXME add several other modes
# - change windows and blocks position
# - change volume / luminosity

# FIXME screenshot
# bindsym --release Print exec --no-startup-id "maim -p 0 -c 0.96,0.5,0.09 $HOME/Pictures/screenshot-$(date +%Y-%m-%d_%H-%M-%S).png"
# bindsym --release Shift+Print exec --no-startup-id "maim -s -p 0 -c 0.96,0.5,0.09 $HOME/Pictures/screenshot-$(date +%Y-%m-%d_%H-%M-%S).png"
# see also: https://github.com/carnager/teiler


# FIXME search engine
# see: https://github.com/DaveDavenport/RandomScripts/blob/master/search_engine.sh

# FIXME custom launcher menu
# see: https://github.com/DaveDavenport/RandomScripts/blob/master/banginator.sh


# FIXME network configuration tool? CLI? start terminal with nmtui?
# FIXME scan/printing modes?
# FIXME resources monitoring CLI tools (atop, conky, etc.)?


# Change display brightness mode
# FIXME see: https://github.com/DaveDavenport/RandomScripts/blob/master/brightness.sh
#set $mode_brightness FIXME
#mode "$mode_brightness" {
    # FIXME use xbacklight ?
#}
#bindsym $mod+FIXME mode "$mode_brightness"
#
# Change sound mode
#set $mode_sound FIXME
#mode "$mode_sound" {
# FIXME use pulseaudio ?
#}
#bindsym $mod+FIXME mode "$mode_sound"

# FIXME useful keys (use "xev" to find key sym and code)
# 22 "Delete" (Suppr)

# Disable focus on mouse movement.
focus_follows_mouse no
# Disable mouse cursor following when switching between workspaces.
mouse_warping none
# Set keymap to fr.
# FIXME should it be put with locales instead ? like xsession ?
# FIXME how about keyboards plugged after i3 startup?
exec --no-startup-id "setxkbmap -layout fr"
# FIXME enable touchpad basic movements
exec --no-startup-id synclient VertEdgeScroll=1 TapButton1=1 TapButton2=1 TapButton3=1
# FIXME disable touchscreen ?


# FIXME volume control
# bindsym XF86AudioRaiseVolume exec pactl set-sink-volume 0 +5% #increase sound volume
# bindsym XF86AudioLowerVolume exec pactl set-sink-volume 0 -5% #decrease sound volume
# bindsym XF86AudioMute exec pactl set-sink-mute 0 toggle # mute sound
#Where 0 is your sink number found with
# pactl list sinks


# Colour management
# No "include" feature on i3, thus this ugly sed hack to update configuration.
#
# ## #INCLUDE# #I3WM# #BEGIN# ##
{# This section is initially loaded by Ansible from another template file. #}
{% include './templates/i3_theme.j2' %}
# ## #INCLUDE# #I3WM# #END# ##


# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
    status_command i3blocks
    position top
    font pango:Hack, FontAwesome 11
    strip_workspace_numbers yes
    separator_symbol "┃"
    bindsym button4 nop
    bindsym button5 nop
    # FIXME to check
    tray_output eDP1
    tray_output LVDS-0
    tray_padding 0
    # i3bar color section
    # No "include" feature on i3, thus this ugly sed hack to update configuration.
    #
    # ## #INCLUDE# #I3BAR# #BEGIN# ##
    {# This section is initially loaded by Ansible from another template file. #}
    {% include './templates/i3bar_theme.j2' %}
    # ## #INCLUDE# #I3BAR# #END# ##
}

######################
# Start applications.
#
# "exec" is used to launch an application at initial startup.
# "exec-always" also executes the command when i3 is restarted.
#
# Note: the "no-startup-id" option is used for launching applications that are
# not startup-notification aware without side effects (like the cursor staying
# on its "loading" shape or animation for 60 seconds even when the application
# has finished starting).  See: https://i3wm.org/docs/userguide.html#exec
# FIXME check which applications support this option
#
# Start network manager.
# FIXME switch to netctl?
# FIXME nm-applet not installed ? also, nm should be loaded using systemd instead
#exec --no-startup-id nm-applet
#
# Start notification tool.
# FIXME should be loaded using .xinitrc ?
exec --no-startup-id dunst
# FIXME see also: https://github.com/DaveDavenport/Rofication
#
# Statup mons as a daemon so it can detect if an external monitor is
# disonnected and reconfigure the display accordingly (mostly usefull for
# laptops).
exec --no-startup-id mons -a
#
# start pulseaudio
# FIXME
#
# FIXME to check
#exec --no-startup-id numlockx on


# Pulse Audio controls
# FIXME https://unix.stackexchange.com/questions/439486/how-can-i-make-fn-keys-work-with-i3/439487#439487
# bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume 0 +5% #increase sound volume
# bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume 0 -5% #decrease sound volume
# bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute 0 toggle # mute sound
#
# # Sreen brightness controls
# # decrease screen brightness
# bindsym XF86MonBrightnessUp exec light -A 5 # increase screen brightness
# bindsym XF86MonBrightnessDown exec light -U 5 # decrease screen brightness
#
#
# # Touchpad controls
# #bindsym XF86TouchpadToggle exec /some/path/toggletouchpad.sh # toggle touchpad
#
# # Media player controls
# bindsym XF86AudioPlay exec playerctl play
# bindsym XF86AudioPause exec playerctl pause
# bindsym XF86AudioNext exec playerctl next
# bindsym XF86AudioPrev exec playerctl previous
#
# #mega
# exec --no-startup-id megasync
# exec --no-startup-id dropbox start
# exec --no-startup-id feh --bg-fill /home/nicomazz97/Immagini/blocks_screen.jpg

# Automatically launch terminal at startup.
exec termite

